<HTML>    <head>        <META HTTP-EQUIV="X-UA-COMPATIBLE" CONTENT="IE=EMULATEIE11">    </head><STYLE type=text/css>TABLE {	BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid; BORDER-LEFT: #000000 1px solid; BORDER-BOTTOM: #000000 1px solid; border-spacing: 0px; }TD {	PADDING-RIGHT: 0.5em; PADDING-LEFT: 0.5em; FONT-SIZE: 10pt; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; FONT-FAMILY: Arial, Helvetica, sans-serif; WHITE-SPACE: nowrap}.mDIV {    border-width: thick;	border-spacing: 20px;	border-color: red;	border-collapse: separate;	background-color: white;}.TableD{  border:solid 1px white; padding: 1px;font-family: Verdana; font-size: 10px;}.PlanRow{font-family: Verdana; font-size: 12px;}.StatRow{font-family: Verdana; font-size: 10px; color:blue;}.textBox{font-family: Verdana; font-size: 10px;}.Button{border:1px solid #A5C983;font-family: Verdana; font-size: 12px;}.TableLight{ border:solid 1px white; padding: 1px;font-family: Verdana; font-size: 10px;}.TableHeader{ background-color: #eff1ff; border:solid 0px #006699; color: black;  font-family: Verdana; font-size: 10px; }.TableHeaderBig{ background-color: #dedede; border:solid 0px #006699; color: black; padding: 1px; font-family: Verdana; font-size: 12px;}.TableHeaderDisable{ background-color: #FF615C; border:none 1px #FF1F31; color: black; padding: 1px; font-family: Verdana; font-size: 11px;}.TableHeaderEnable{ background-color: #7FD170; border:none 1px #7FD179; color: black; padding: 1px; font-family: Verdana; font-size: 10px;}.Cells{ background-color: #ffffff; border:solid 0px #006699; color: black; padding: 1px; font-family: Verdana; font-size: 12px;}</STYLE><SCRIPT language=javascript src="../utils/alloc_logic.js"></SCRIPT><SCRIPT language=javascript src="../utils/level_bar.js"></SCRIPT><SCRIPT language=javascript src="../utils/utilfuncs.js"></SCRIPT><SCRIPT language=javascript src="../utils/sorttable.js"></SCRIPT><SCRIPT>var G_nTotal = 4;var G_strLastCardType = "";var G_strLastCmdResBoxId = "";var G_arAddresses	= new Array();var G_arTypes		= new Array();////////////////////////		Hashtable.prototype.hash 	 = null;        Hashtable.prototype.keys 	 = null;        Hashtable.prototype.location = null;        function Hashtable(){            this.hash = new Array();            this.keys = new Array();            this.location = 0;        }        Hashtable.prototype.get = function (key){            return this.hash[key];        }        Hashtable.prototype.put = function (key, value){            if (value == null)                return null;            if (this.hash[key] == null)                this.keys[this.keys.length] = key;            this.hash[key] = value;        }//declare an instance//ETSI GSM 03.38var items = new Hashtable();items.put("00","%40");items.put("01","%A3");items.put("02","%24");items.put("03","%A5");items.put("04","%E8");items.put("05","%E9");items.put("06","%F9");items.put("07","%EC");items.put("08","%F2");items.put("09","%E7");items.put("0B","%D8");items.put("0C","%F8");items.put("0E","%C5");items.put("0F","%E5");items.put("11","%5F");items.put("1B14","%5E");items.put("1B28","%7B");items.put("1B29","%7D");items.put("1B2F","%5C");items.put("1B3C","%5B");items.put("1B3D","%7E");items.put("1B3E","%5D");items.put("1B40","%7C");items.put("1C","%C6");items.put("1D","%E6");items.put("1E","%DF");items.put("1F","%C9");items.put("20","%20");items.put("21","%21");items.put("22","%22");items.put("23","%23");items.put("24","%A4");items.put("25","%25");items.put("26","%26");items.put("27","%27");items.put("28","%28");items.put("29","%29");items.put("2A","%2A");items.put("2B","%2B");items.put("2C","%2C");items.put("2D","%2D");items.put("2E","%2E");items.put("2F","%2F");items.put("30","%30");items.put("31","%31");items.put("32","%32");items.put("33","%33");items.put("34","%34");items.put("35","%35");items.put("36","%36");items.put("37","%37");items.put("38","%38");items.put("39","%39");items.put("3A","%3A");items.put("3B","%3B");items.put("3C","%3C");items.put("3D","%3D");items.put("3E","%3E");items.put("3F","%3F");items.put("40","%A1");items.put("41","%41");items.put("42","%42");items.put("43","%43");items.put("44","%44");items.put("45","%45");items.put("46","%46");items.put("47","%47");items.put("48","%48");items.put("49","%49");items.put("4A","%4A");items.put("4B","%4B");items.put("4C","%4C");items.put("4D","%4D");items.put("4E","%4E");items.put("4F","%4F");items.put("50","%50");items.put("51","%51");items.put("52","%52");items.put("53","%53");items.put("54","%54");items.put("55","%55");items.put("56","%56");items.put("57","%57");items.put("58","%58");items.put("59","%59");items.put("5A","%5A");items.put("5B","%C4");items.put("5C","%D6");items.put("5D","%D1");items.put("5E","%DC");items.put("5F","%A7");items.put("60","%BF");items.put("61","%61");items.put("62","%62");items.put("63","%63");items.put("64","%64");items.put("65","%65");items.put("66","%66");items.put("67","%67");items.put("68","%68");items.put("69","%69");items.put("6A","%6A");items.put("6B","%6B");items.put("6C","%6C");items.put("6D","%6D");items.put("6E","%6E");items.put("6F","%6F");items.put("70","%70");items.put("71","%71");items.put("72","%72");items.put("73","%73");items.put("74","%74");items.put("75","%75");items.put("76","%76");items.put("77","%77");items.put("78","%78");items.put("79","%79");items.put("7A","%7A");items.put("7B","%E4");items.put("7C","%F6");items.put("7D","%F1");items.put("7E","%FC");items.put("7F","%E0");//////////////////////UTILS///////////////////function getDateTime(){    var now=new Date();    var hrs=now.getHours();    var min=now.getMinutes();    var sec=now.getSeconds();    min = ((min<10) ? "0" : "")+min;    sec = ((sec<10) ? "0" : "")+sec;    clock = hrs + ":" + min + ":" + sec;    var mydate=new Date()    var year=mydate.getYear()    if (year < 1000)    year+=1900    var day=mydate.getDay()    var month=mydate.getMonth()+1    if (month<10)    month="0"+month    var daym=mydate.getDate()    if (daym<10)    daym="0"+daym    date = daym + "/" + month + "/" + year;    return (date + " "  + clock);}function isValidUSSDCmd( strMessage ){	if ( typeof( strMessage ) == "undefined" || strMessage == "")	{       alert ( "USSD string must contain only 0-9,*,#");		return false;	}	var regex=/^[0-9#\*\,]+$/;	if (regex.test(strMessage))	{		return true;	}	else	{       alert ( "USSD string must contain only 0-9,*,#");		return false;	}}function importTopups(){   //document.getElementById( "importTopups" ).display = true;    strImportDiv = "<br><textarea  placeholder='Copy here Topups commands separated by new line' id='iporttopupstext' rows='21' cols='25'></textarea><br>";    strImportDiv += "<a href='javascript:getTopupText()' style='text-decoration: none;'><img border='0' src='../Up-AddToList.jpg' alt='Click to set y for all marked channels'></a>"    document.getElementById( "ipmortopups" ).innerHTML = strImportDiv;}function getTopupText(){    checkLoop(3);}function exportToExcel(){    var oExcel  = new ActiveXObject("Excel.Application");    var oBook   = oExcel.Workbooks.Add;    var oSheet  = oBook.Worksheets(1);    detailsTable = document.getElementById('USSD_Table');    titlesTable = document.getElementById('USSD_Table_T');    for (var y=0;y<titlesTable.rows.length;y++)    // USSD_Table is the table where the content to be exported is    {            var xx =0;            for (var x=0;x<titlesTable.rows(y).cells.length;x++)            {                if (  x!=3 && x!=4 && x!=5)                {                    oSheet.Cells(y+1,xx+1) = titlesTable.rows(y).cells(x).innerText;                    xx++;                }            }    }    for (var y=0;y<detailsTable.rows.length;y++)    // USSD_Table is the table where the content to be exported is    {            var xx =0;            for (var x=0;x<detailsTable.rows(y).cells.length;x++)            {                if ( x!=3 && x!=4 && x!=5)                {                    oSheet.Cells(y+2,xx+1) = detailsTable.rows(y).cells(x).innerText;                    xx++;                }            }    }    oExcel.Visible = true;    oExcel.UserControl = true;}/////////////////////ON DATA///////////////////function OnData( strMessage ){    var strCommand = new String( strMessage );    var strParam = strCommand.split( " " );    var strSection;    var nCommandStart = strParam[0].length + 1;    var strCommandParam = strMessage.substr( nCommandStart );    var packStr = new PacketString( strCommandParam );	var newStrRes = "";    switch ( strParam[0] )    {		case "GWError":        {            if ( packStr.getSection( "I" ) == 144 || packStr.getSection( "I" ) == 166 )            {                var USSDRes = "";                if ( packStr.getSection( "R" ) == "6F" )                   USSDRes = "Not Supported";                else if ( packStr.getSection( "R" ) == "22" )                   USSDRes = "Not Ready";                else                   USSDRes = "Error";                 document.getElementById(G_strLastCmdResBoxId).innerHTML = USSDRes;                 var id = G_strLastCmdResBoxId.replace('ID_Reply_','ID_Reply_Date_');                 document.getElementById(id).innerHTML = getDateTime();                 checkBalanceArray();            }            else                alert( "Got error message:" + strMessage );            break;        }        case "Ack":        {			//alert( packStr.m_strMessage );            if      ( packStr.getSection( "I" ) == 144 )            {               checkBalanceArray();            }            else if ( packStr.getSection( "I" ) == 166 )            {               rechargeBalanceArray();            }            else if ( packStr.getSection( "I" ) == 199 )            {            }            break;        }		case "GenericReply":		{            if  ( packStr.getSection( "I" ) == 144 || packStr.getSection( "I" ) == 166 )            {                //avoiding using the getSection func because /h is a valid string in the replay so the getSection cut the message.                var strReplay = strMessage.substr( strMessage.indexOf("/g") );                res = strReplay.split('"');                add = packStr.getSection( "@" );                mod = packStr.getSection( "r" );                txtResId = "ID_Reply_" + add + "_" + mod;                strRes =  res[1];				if (strRes != "")				{					if (packStr.getSection( "i" ) == 72 )			 //UCS2 USSD message					{						for ( i=0 ; i<strRes.length ; i+=4 )						{							newStrRes += String.fromCharCode( parseInt( strRes.substring(i, i+4) , 16) );						}						strRes = newStrRes;					}					else if (packStr.getSection( "X" ) != null)					{						var arStrIsHex = true;						for ( i=0; i<strRes.length; i++ )						{							if ( !( ( (strRes.charAt(i) >= '0') && (strRes.charAt(i) <= '9') ) ||							        ( (strRes.charAt(i) >= 'a') && (strRes.charAt(i) <= 'f') ) ||							        ( (strRes.charAt(i) >= 'A') && (strRes.charAt(i) <= 'F') )   ) )							{								arStrIsHex = false;							}						}						if ( arStrIsHex == true )						{							//string in GSM 03.38							for ( i=0; i<strRes.length; i++ )							{								if ( (strRes.charAt(i) + strRes.charAt(i+1) ) != "1B")									newStrRes +=items.get(strRes.charAt(i) + strRes.charAt(++i))								else									newStrRes +=items.get(strRes.charAt(i) + strRes.charAt(++i) + strRes.charAt(++i) + strRes.charAt(++i) );							}							strRes = unescape(newStrRes);						}					}				}                //clean undefined string from reply (for kenya)				var find = 'undefined';                var re = new RegExp(find, 'g');                strRes = strRes.replace(re, '');                document.getElementById(txtResId).innerHTML = ( strRes == "" ) ? "Answer is an empty string" : strRes;                document.getElementById((txtResId.replace('ID_Reply_','ID_Reply_Date_'))).innerHTML = getDateTime();            }            break;       }        case "GWConfigInfo":        {			//alert ( strMessage );			//first check if there is any CG card on GW:            var objSelect = G_configInfo.getSelectCardHTML( packStr, "CG4.0,CU4.1", "Select cellular card", "onSelectCard" );			var strSelCard = objSelect.m_strSelCard;            if ( strSelCard == null )            {				document.getElementById( "ID_WideAngleTable" ).innerHTML = "<font face=Arial size=2>No cellular card was detected.";				return;            }			G_configInfo.processConfigInfo( packStr );			FillCardType( "CG4.0" );			FillCardType( "CU4.1" );			dispalyBalanceTable();            break;        }        default:        {            break;        }    }}////////////////////UI//////////////////function showInfo( str ){    document.getElementById('stat').innerHTML = str;    setTimeout("document.getElementById('stat').innerHTML = ''",3000);}function getInput( id, value, type ){    var div = document.createElement('div');	var input = document.createElement("input");	input.setAttribute("type",type);	input.setAttribute("id",id  );	input.className = "textBox";	input.setAttribute("size","28");	input.setAttribute("value",value);    div.appendChild(input);	return div.innerHTML;}function cleanAllCommands(){    for (var i=0; i<G_arAddresses.length; i++)    {        for (var j=0; j<4; j++ )        {            var strAddress = G_arAddresses[ i ];            var cbid = 'recharge_txt_' + strAddress + "_" +(j+1);            document.getElementById( cbid ).value = "";        }    }}function checkThemAll(bcheck){    for (var i=0; i<G_arAddresses.length; i++)	{		for (var j=0; j<4; j++ )		{			var strAddress = G_arAddresses[ i ];            var cbid = 'cb_check' + strAddress + "_" +(j+1);            var cb = document.getElementById( cbid );            cb.checked = bcheck;        }    }    if ( bcheck )    {     document.getElementById( 'td_checkall' ).innerHTML = "<a href='javascript:checkThemAll(false)' style='text-decoration: none;'><img border='0' src='red_x.gif' alt='Click to unmark all channels'></a>";    }    else    {        document.getElementById( 'td_checkall' ).innerHTML = "<a href='javascript:checkThemAll(true)' style='text-decoration: none;'><img border='0' src='blue_v.gif' alt='Click to mark all channels'></a>";    }}function dispalyBalanceTable(){    if ( G_arAddresses.length == 0 )    {       document.getElementById( "ID_WideAngleTable" ).innerHTML = "<font face=Arial size=2>No cards detected!";       return;    }    var strHTMLCmds = "";    var strHTMLTitle = "";    var strHTML = "";    //draw 2 global txt box     strHTMLCmds += "<table class='TableD'>";     strHTMLCmds += "<tr><td class='PlanRow'>Balance checking USSD string:</td><td>" + getInput('txt_check_cmd','', "text") + "</td>";     strHTMLCmds += "<th rowspan='2'><a href='javascript:setUSSDComands()' style='text-decoration: none;'><img border='0' src='save.gif' alt='Click for saving USSD balance strings'></a> <a href='javascript:delUSSDComands()' style='text-decoration: none;'><img border='0' src='deleteme.gif' alt='Click for deleting USSD balance strings'></a></th></tr>"     strHTMLCmds += "<tr><td class='PlanRow'>Recharging USSD string:</td><td>" + getInput('txt_recharge_cmd','', "text") + "</td></tr>";     strHTMLCmds += "</table>";     strHTMLCmds += "<div id='stat' class='StatRow'></div><br>";    //draw table    strHTMLTitle += "<table  class='TableD' id='USSD_Table_T'><tr class='TableHeaderEnable'>";    strHTMLTitle += "<td class='PlanRow' width='40px'>Slot</td>";    strHTMLTitle += "<td class='PlanRow' width='40px'>Ch.</td>";    strHTMLTitle += "<td class='PlanRow' width='50px'>Media Link</td>";    strHTMLTitle += "<td class='PlanRow' width='50px'>Check All</td>";    strHTMLTitle += "<td class='PlanRow' width='60px'>Check Balance</td>";    strHTMLTitle += "<td class='PlanRow' width='170px'>Recharge Balance</td>";    strHTMLTitle += "<td class='PlanRow' width='170px'>USSD Reply</td>";    strHTMLTitle += "<td class='PlanRow' width='100px'>Reply Date</td>";    strHTMLTitle += "</tr>";    strHTMLTitle += "</table>";    strHTML += "<div style='float: left;'><table class='TableD' id='USSD_Table'>";	for (var i=0; i<G_arAddresses.length; i++)	{       var arMedia = G_configInfo.getMatrixAllocations(G_arAddresses[i]);		for (var j=0; j<4; j++ )		{			var strAddress = G_arAddresses[ i ];            var strMediaLink =  ( arMedia[j].split('.')[0].indexOf('MG') > -1 ) ? 'MG' : arMedia[j].split('.')[0] ;            strMediaLink = ( strMediaLink =='' ) ? '-' :  G_configInfo.addr2Name( arMedia[j].split('.')[0] );            //alert ( strMediaLink );			strHTML += "<tr>";            //slot            strHTML += "<td class='TableHeader' align='center' width='40px'>";			strHTML += (parseInt( strAddress, 16 ) - 0x20);			strHTML += "</td>";			//module            strHTML += "<td class='TableHeader' align='center' width='40px'>";			strHTML +=  (j+1);			strHTML += "</td>";            //media            strHTML += "<td class='TableHeader' align='center' width='50px'>";			strHTML +=  ( strMediaLink == '-' ) ? "-" : strMediaLink + " Ch." + arMedia[j].split('.')[1];			strHTML += "</td>";            //check all            strHTML += "<td  class='TableHeader' align='center' valign='top' width='50px'>";            strHTML += getInput('cb_check' + strAddress + "_" +(j+1),'', "checkbox");			strHTML += "</td>";			//check            strHTML += "<td class='TableHeader' align='center' valign='middle' width='60px' >";			strHTML += "<a href='javascript:checkBalance(\"" + strAddress + "\"," + (j+1) +")' style='text-decoration: none;'><img border='0' src='checki.gif' alt='Click for checking SIM balance'></a> ";			strHTML += "</td>";			//recharge            strHTML += "<td  class='TableHeader'align='center' valign='top' width='170px'>";            strHTML += getInput('recharge_txt_' + strAddress + "_" +(j+1),'', "text");            strHTML += "  <a href='javascript:rechargeBalance(\"" + strAddress + "\"," + (j+1) +")' style='text-decoration: none;'><img border='0' src='recharge.gif' alt='Enter deatils and click for recharge SIM balance'></a> ";			strHTML += "</td>";			//Reply			strHTML += "<td class='TableHeader' id='ID_Reply_" + strAddress + "_" + (j+1) + "' width='170px' align='center' valign='middle'>";			strHTML += "</td>";			//date            strHTML += "<td class='TableHeader' id='ID_Reply_Date_" + strAddress + "_" + (j+1) + "' width='100px' align='center' valign='middle'>";			strHTML += "</td>";			strHTML += "</tr>";		}        strHTML += "<tr><td colspan=5></td></tr>";    }    strHTML += "</table></div>";    strHTMLBottom =  "<table class='TableD' id=''>";    strHTMLBottom += "<tr><td class='TableHeader'  width='135'></td>";    strHTMLBottom += "<td class='TableHeader' id='td_checkall' align='center' width='50px'><a href='javascript:checkThemAll(true)' style='text-decoration: none;'><img border='0' src='blue_v.gif' alt='Click to mark all channels'></a></td>";    strHTMLBottom +=  "<td class='TableHeader' align='center' width='60px'><a href='javascript:checkLoop(1)' style='text-decoration: none;'><img border='0' src='checki.gif' alt='Click to check balance for all marked channels'></a></td>";    strHTMLBottom +=  "<td class='TableHeader' align='center' width='170px'><a href='javascript:checkLoop(2)' style='text-decoration: none;'><img border='0' src='recharge.gif' alt='Click for recharge SIM balance for all marked channels'></a></td>";    strHTMLBottom +=  "<td class='TableHeader' colspan='1' align='right' valign='center' width='170px'>";    strHTMLBottom +=  "<a href='javascript:importTopups()' style='text-decoration: none;'><img border='0' src='add.gif' alt='Import topup commands string'></a>";    strHTMLBottom += "</td>"    strHTMLBottom +=  "<td class='TableHeader' colspan='1' align='center' valign='center' width='100px'>";    strHTMLBottom += "<a href='javascript:exportToExcel()' style='text-decoration: none;'><img border='0' src='excel.gif' alt='Export to Excel'></a>";    strHTMLBottom += "</td></tr>";	strHTMLBottom += "</table>";    strHTML += '<div id="ipmortopups" style="width:30px;border: 0px solid #666;padding: 0px;display:hide;"></div>';    document.getElementById( "cmds" ).innerHTML = strHTMLCmds;    document.getElementById( "title" ).innerHTML = strHTMLTitle;    document.getElementById( "ID_WideAngleTable" ).innerHTML = strHTML;    document.getElementById( "bottom" ).innerHTML = strHTMLBottom;    getUSSDComands();}/////////////////////SERVER COMMANDS////////////////////function rechargeBalance(add,mod){    //get the cmd msg from UI    var cmdRecharge = document.getElementById('txt_recharge_cmd').value;    var cmdRechargeTxt = document.getElementById('recharge_txt_' + add + "_" + mod).value;    if (!isValidUSSDCmd( cmdRecharge + cmdRechargeTxt ))    {        return;    }    var strCommand = "SendGenericPacket 27:/A" + add + "/r" + mod + "/n" + cmdRecharge + cmdRechargeTxt + "/I166" ;    //alert ( strCommand );    G_strLastCmdResBoxId = "ID_Reply_" + add + "_" + mod;    parent.frames[0].SendCommand( strCommand );}function checkBalance(add,mod){    //get the cmd msg from UI    var cmdCheck = document.getElementById('txt_check_cmd').value;    if (!isValidUSSDCmd( cmdCheck ))    {        return;    }    var strCommand = "SendGenericPacket 27:/A" + add + "/r" + mod + "/n" + cmdCheck + "/I144" ;    G_strLastCmdResBoxId = "ID_Reply_" + add + "_" + mod;    parent.frames[0].SendCommand( strCommand );}var G_AddressModuleArray = new Array();var G_AddresssModuleIndex = 0;function checkLoop( nCmd ){    var cmdElemId = "";    var cbElemId  = 'cb_check';    var hFunc = "";    if ( nCmd == 1) //check balance    {        cmdElemId = 'txt_check_cmd';        hFunc     = 'checkBalanceArray()';    }    else    if ( nCmd == 2) //recharge    {        cmdElemId = 'txt_recharge_cmd';        hFunc = 'rechargeBalanceArray()';    }    if ( nCmd == 3) //recharge    {        cmdElemId = 'txt_check_cmd';        hFunc = 'fillAllCheckedCommands()';    }    G_AddresssModuleIndex = 0;    G_AddressModuleArray = new Array();    var cmdCheck = document.getElementById( cmdElemId ).value;    if (!isValidUSSDCmd( cmdCheck))    {   alert("return");        return;    }    var checkArray = new Array();    var pos = 0;    for (var i=0; i<G_arAddresses.length; i++)	{		for (var j=0; j<4; j++ )		{            var strAddress = G_arAddresses[ i ];            var cbid = cbElemId + strAddress + "_" +(j+1);            var cb = document.getElementById( cbid );            if (  cb.checked == true )            {                G_AddressModuleArray[ pos++ ] = strAddress + "|" + (j+1);            }        }    }    if ( nCmd==3 || G_AddressModuleArray.length > 0 )        eval( hFunc );}function checkBalanceArray(){    if ( G_AddresssModuleIndex < G_AddressModuleArray.length )    {        arAddMod = G_AddressModuleArray[G_AddresssModuleIndex].split('|');        checkBalance ( arAddMod[0], arAddMod[1] );        G_AddresssModuleIndex++;    }    else    {       showInfo( "Check loop completed!" );    }}function fillAllCheckedCommands(){    var strTopUpsText = document.getElementById( "iporttopupstext" ).value;    //alert(strTopUpsText.length + " - " + G_AddressModuleArray.length);    if(strTopUpsText.length===0 || G_AddressModuleArray.length===0)    {        alert("Please select channel and insert topup code!")        return;    }    cleanAllCommands();    var coordinates = strTopUpsText.split( "\r\n" );    //console.log(coordinates);    for ( var i=0;i < G_AddressModuleArray.length; i++ )    {        arAddMod = G_AddressModuleArray[i].split('|');        //checkBalance ( arAddMod[0], arAddMod[1] );        if (i>=coordinates.length)            document.getElementById('recharge_txt_' + arAddMod[0] + "_" + arAddMod[1]).value = "";        else            document.getElementById('recharge_txt_' + arAddMod[0] + "_" + arAddMod[1]).value = coordinates[i];    }       showInfo( "Check loop completed!" );}function rechargeBalanceArray(){    if ( G_AddresssModuleIndex < G_AddressModuleArray.length )    {        arAddMod = G_AddressModuleArray[G_AddresssModuleIndex].split('|');        rechargeBalance( arAddMod[0], arAddMod[1] );        G_AddresssModuleIndex++;    }    else    {       showInfo( "Check loop completed!" );    }}function getGWConfig(){    parent.frames[0].SendCommand( "GetGWConfig" );}function FillCardType( strType ){	var arTypeAddr = G_configInfo.getCardTypeAddresses( strType );	if ( typeof( arTypeAddr ) != 'undefined' )	{		for (var i=0; i<arTypeAddr.length; i++)		{			G_arTypes.push( strType );		}		G_arAddresses = G_arAddresses.concat( arTypeAddr );	}}var G_nCG4MonitorTimerID;var G_nCurrent = 0;///////////////////////////USSD COMMANDS DATABASE/////////////////////////function getUSSDComands(){    document.getElementById('stat').innerHTML = "";    var strCommand = "GetValue USSDComands";    var strList = MaptiveX.Send( strCommand );    if ( strList != "" )    {        var arParams = strList.split( "|" );        document.getElementById('txt_check_cmd').value = arParams[0];        document.getElementById('txt_recharge_cmd').value = arParams[1];    }}function setUSSDComands(){    var cmdCheck = document.getElementById('txt_check_cmd').value;    var cmdRecharge = document.getElementById('txt_recharge_cmd').value;    var strCommand = "SetValue USSDComands " + cmdCheck + "|" + cmdRecharge;    var res = MaptiveX.Send( strCommand );    var stat = ( res == "1 Ok" ) ? "USSD strings successfully updated!" : "Error saving USSD string";    showInfo( stat );}function delUSSDComands(){    document.getElementById('txt_check_cmd').value    = "";    document.getElementById('txt_recharge_cmd').value = "";    setUSSDComands();}</SCRIPT><object id="MaptiveX" width="1" height="1"     classid="CLSID:a5243cda-45bb-408e-8bb6-f999692c77a3"     codebase="HMX.ocx"></object><BODY onLoad="getGWConfig();" bgcolor="white" ><font size=4 face="Arial">USSD SIM Balance</font><hr></font><font size=1 face="Arial"><br><div id="cmds"></div><div id="title"></div><div id="ID_WideAngleTable" style="height: 380px;overflow: auto; border: 0px solid #666;padding: 0px;"></div><div id="bottom"></div></font></BODY></HTML>